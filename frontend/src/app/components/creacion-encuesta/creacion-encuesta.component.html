<!-- Elementos decorativos de fondo -->
<div class="background-elements">
  <!-- Formas flotantes principales -->
  <div class="floating-shape shape-1"></div>
  <div class="floating-shape shape-2"></div>
  <div class="floating-shape shape-3"></div>
  <div class="floating-shape shape-4"></div>

  <!-- C√≠rculos flotantes adicionales -->
  <div class="floating-circle circle-1"></div>
  <div class="floating-circle circle-2"></div>
  <div class="floating-circle circle-3"></div>
  <div class="floating-circle circle-4"></div>
  <div class="floating-circle circle-5"></div>
  <div class="floating-circle circle-6"></div>
  <div class="floating-circle circle-7"></div>
  <div class="floating-circle circle-8"></div>

  <!-- Formas org√°nicas adicionales -->
  <div class="organic-shape blob-1"></div>
  <div class="organic-shape blob-2"></div>
  <div class="organic-shape blob-3"></div>
  <div class="organic-shape blob-4"></div>

  <!-- Elementos adicionales para m√°s dinamismo -->
  <div class="geometric-shape triangle-1"></div>
  <div class="geometric-shape triangle-2"></div>
  <div class="geometric-shape hexagon-1"></div>
  <div class="geometric-shape hexagon-2"></div>

  <!-- C√≠rculos con anillos -->
  <div class="ring-circle ring-1"></div>
  <div class="ring-circle ring-2"></div>

  <!-- Part√≠culas brillantes -->
  <div class="sparkle sparkle-1"></div>
  <div class="sparkle sparkle-2"></div>
  <div class="sparkle sparkle-3"></div>
  <div class="sparkle sparkle-4"></div>
  <div class="sparkle sparkle-5"></div>
  <div class="sparkle sparkle-6"></div>

  <!-- Ondas de fondo -->
  <div class="wave wave-1"></div>
  <div class="wave wave-2"></div>
</div>

<!-- Contenido principal -->
<div class="main-content">
  <form [formGroup]="form" (ngSubmit)="confirmarCrearEncuesta()">
    <div id="contenedor-encuesta">
      <h1 class="page-title">Cre√° una encuesta</h1>

      <!-- Mensaje informativo -->
      <div class="info-message">
        <p><strong>üìù Instrucciones:</strong></p>
        <p>1. Ingresa un nombre para tu encuesta</p>
        <p>2. Agrega al menos una pregunta usando el bot√≥n "Agregar Pregunta"</p>
        <p>3. Haz clic en "Finalizar" para crear tu encuesta</p>
        <p class="connectivity-note">üí° Si tienes problemas:</p>
        <p class="connectivity-note">‚Ä¢ Usa el bot√≥n "Probar Conectividad" para verificar la conexi√≥n</p>
        <p class="connectivity-note">‚Ä¢ Aseg√∫rate de que el backend est√© ejecut√°ndose en el puerto 3000</p>
        <p class="connectivity-note">‚Ä¢ Revisa la consola del navegador (F12) para m√°s detalles</p>
      </div>
    <app-seccion>
      <p-floatlabel variant="on" id="float-label-nombre-encuesta">
        <input
          pInputText
          id="input-nombre"
          formControlName="nombre"
          autocomplete="off"
        />
        <label for="input-nombre">Nombre de la encuesta</label>
      </p-floatlabel>
      @if (nombre.invalid && nombre.touched) {
        <app-texto-error>Requerido</app-texto-error>
      }
    </app-seccion>
    @for (pregunta of preguntas.value; track idx; let idx = $index) {
      <app-seccion>
        <div class="contenedor-pregunta">
          <p class="texto-pregunta">
            {{ pregunta.texto }} ({{
              getTipoPreguntaPresentacion(pregunta.tipo)
            }})
          </p>
          <ul>
            @for (opcion of pregunta.opciones; track i; let i = $index) {
              <li>
                <p class="texto-opcion">{{ opcion.texto }}</p>
              </li>
            }
          </ul>
          <div class="botonera-pregunta">
            <p-button
              (onClick)="confirmarEliminarPregunta(idx)"
              id="boton-eliminar-pregunta"
              icon="pi pi-times"
              label="Eliminar"
              severity="danger"
            ></p-button>
          </div>
        </div>
      </app-seccion>
    }
    <app-seccion>
      <p-button
        label="Agregar Pregunta"
        (onClick)="abrirDialog()"
        icon="pi pi-plus"
      />
      @if (preguntas.invalid && form.touched) {
        <app-texto-error>Debe agregar al menos una pregunra</app-texto-error>
      }
    </app-seccion>
    <!-- Bot√≥n temporal para probar conectividad -->
    <p-button
      label="üîó Probar Conectividad"
      (onClick)="probarConectividad()"
      severity="info"
      [outlined]="true"
      [style]="{'margin-bottom': '1rem'}"
    />

    <button
      id="boton-finalizar"
      pButton
      pRipple
      type="submit"
      icon="pi pi-check"
      severity="contrast"
    >
      Finalizar
    </button>
  </div>
</form>
</div>

<app-gestion-pregunta-dialog
  [(visible)]="dialogGestionPreguntaVisible"
  (agregarPregunta)="agregarPregunta($event)"
/>